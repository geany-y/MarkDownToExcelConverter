# 製品仕様書 (Product Specification)

## 1. 概要
Markdownファイルを文書構造とインデントを保持したままExcel形式に変換するElectronデスクトップアプリケーションです。主に日本語ユーザー向けに開発されており、階層構造を維持したExcelスプレッドシート（方眼紙形式）への変換を目的とします。

## 2. 主要機能
- **構造保持**: Markdownの見出し、リスト、コードブロック等の構造とインデントレベルを保持。
- **方眼紙形式出力**: セルの列幅と行高さが統一されたExcel形式で出力。
- **書式変換**: Markdownのインライン書式（太字、斜体等）をExcelのリッチテキスト書式に変換。
- **GUIインターフェース**: ファイル選択用のシンプルなインターフェースを提供。
- **クロスプラットフォーム**: Windows、macOS、Linuxに対応。

## 3. 対象ユースケース
構造化されたドキュメントを、視覚的階層を維持したままExcel形式で閲覧・編集したい場合。

## 4. 要件定義

### 要件1: 基本的な変換フロー
- ユーザーがMarkdownパスを指定すると、内容を解析・読み込む。
- ファイルが存在しない場合は適切なエラーメッセージを表示する。
- 指定されたパスにExcelファイルを生成し、完了時に成功メッセージを表示する。

### 要件2: インデント構造の表現
- スペース（4スペース=1レベル）およびタブによるインデントを正確に検出する。
- インデント1レベルにつき、Excelの列を1列右にシフトして配置する。
- 混在したインデント形式に対しても一貫したルールでレベルを決定する。

### 要件3: 要素の変換（表を除く）
- 見出し、段落、リスト、コードブロックを適切に変換して出力する。
- 表形式のデータは変換対象から除外し、「表：[元の内容]」として出力する。

### 要件4: Excelレイアウト
- すべてのセルの列幅と行高さを統一（方眼紙形式）。
- 複数行にわたる内容は別々のExcel行に配置し、Markdownの空行も保持する。

### 要件5: 書式適用
- 見出しレベルに応じたフォントサイズ調整。
- 太字、斜体、取り消し線をExcelのリッチテキストで表現。
- リンク（ハイパーリンク）、画像（代替テキスト出力＋背景色）、インラインコード（等幅フォント＋背景色）。
- 引用（左境界線＋背景色）、水平線（下境界線）。
- 複数の書式が組み合わされた場合の同時適用。
